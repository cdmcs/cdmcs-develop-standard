---
title: 成都地图
date: 2023-04-08
category:
  - 公共组件说明
---

<!-- more -->


:::tip
<a href="/demo/cdmap-demo.zip" download>使用示例下载</a>
:::

## 项目目录
```text
- cdmap
    - index.min.css
    - index.min.js
```

## 参数说明
| 参数名        | 类型     | 说明                                             | 示例(可选值)                                                                                                         |
| :------------ | :------- | :----------------------------------------------- | :------------------------------------------------------------------------------------------------------------------- |
| draw          | Boolean  | 是否可以画图                                     | 可选值为true、false                                                                                                  |
| draw-graph    | Object   | 地图初始化时需要加载哪些图形，暂时仅支持单个图形 | 传参示例见下                                                                                                         |
| draw-complete | Function | 画完图形后返回图形的信息                         | 返回参数示例见下，会在图案绘制完成、图案绘制更新完成，撤销上一步图案、取消撤销上一步图案绘制时都会返回图案的几何信息 |
| mapType       | String   | 渲染的地图类型                                   | 可选值为：imageservice——影像电子地图和default——电子地图标准版                                                        |
| tools         | Array    | 画图工具，数组内值的顺序就是渲染的顺序           | 可选值为："point"、"polyline"、"polygon"、"rectangle"、"circle"                                                      |


## draw-graph
`draw-graph`接收的json格式如下：
```js
// 传矩形
{
  type: "rectangle",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传圆
{
  type: "circle",
  rings: [
    [104.06408710611295, 30.66002142313316],
    [104.06408343112088, 30.659951300107068],
    [104.06407244640864, 30.659881945363523],
    [104.06405427232704, 30.659814118767613],
    [104.06402910799513, 30.65974856344171],
    [104.06399722911857, 30.65968599762369],
    [104.06395898496903, 30.65962710679774],
    [104.0639147945574, 30.65957253618408],
    [104.0638651420431, 30.659522883669766],
    [104.06381057142943, 30.65947869325814],
    [104.06375168060349, 30.6594404491086],
    [104.06368911478546, 30.65940857023205],
    [104.06362355945956, 30.659383405900133],
    [104.06355573286365, 30.659365231818533],
    [104.0634863781201, 30.659354247106293],
    [104.06341625509401, 30.659350572114217],
    [104.06334613206792, 30.659354247106293],
    [104.06327677732438, 30.659365231818533],
    [104.06320895072847, 30.659383405900133],
    [104.06314339540256, 30.65940857023205],
    [104.06308082958454, 30.6594404491086],
    [104.0630219387586, 30.65947869325814],
    [104.06296736814492, 30.659522883669766],
    [104.06291771563062, 30.65957253618408],
    [104.06287352521899, 30.65962710679774],
    [104.06283528106945, 30.65968599762369],
    [104.0628034021929, 30.65974856344171],
    [104.06277823786098, 30.659814118767613],
    [104.06276006377938, 30.659881945363523],
    [104.06274907906715, 30.659951300107068],
    [104.06274540407507, 30.66002142313316],
    [104.06274907906715, 30.66009154615925],
    [104.06276006377938, 30.660160900902795],
    [104.06277823786098, 30.660228727498705],
    [104.0628034021929, 30.66029428282461],
    [104.06283528106945, 30.66035684864263],
    [104.06287352521899, 30.66041573946858],
    [104.06291771563062, 30.66047031008224],
    [104.06296736814492, 30.660519962596553],
    [104.0630219387586, 30.660564153008178],
    [104.06308082958454, 30.660602397157717],
    [104.06314339540256, 30.66063427603427],
    [104.06320895072847, 30.660659440366185],
    [104.06327677732438, 30.660677614447785],
    [104.06334613206792, 30.660688599160025],
    [104.06341625509401, 30.6606922741521],
    [104.0634863781201, 30.660688599160025],
    [104.06355573286365, 30.660677614447785],
    [104.06362355945956, 30.660659440366185],
    [104.06368911478546, 30.66063427603427],
    [104.06375168060349, 30.660602397157717],
    [104.06381057142943, 30.660564153008178],
    [104.0638651420431, 30.660519962596553],
    [104.0639147945574, 30.66047031008224],
    [104.06395898496903, 30.66041573946858],
    [104.06399722911857, 30.66035684864263],
    [104.06402910799513, 30.66029428282461],
    [104.06405427232704, 30.660228727498705],
    [104.06407244640864, 30.660160900902795],
    [104.06408343112088, 30.66009154615925],
    [104.06408710611295, 30.66002142313316],
  ],
}

// 传多边形
{
  type: "polygon",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传折线图
{
  type: "polyline",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传点
{
  type: "point",
  rings: [104.06342161350676, 30.660008027101323],
},
```

由上可见`type`可以传的值有：
- `circle`——圆
- `rectangle`——矩形
- `polygon`——多边形
- `polyline`——折线图
- `point`——点

`rings`就是图案边框上坐落的坐标，组件会根据`rings`坐标组和`type`图案类型来绘制图案。需要注意的是，`rings`坐标都要为wgs84坐标类型，反正在地图上绘制会出现偏差

## draw-complete
`draw-complete`函数返回值如下：
```js
{
    "type": "point",
    "coordsType": "wgs84",
    "center": [
        104.06341089668128,
        30.66001338551406
    ],
    "rings": [
        104.06341089668128,
        30.66001338551406
    ]
}
```

以上`type`的值可以参考上面`type`的取值，`coordsType`返回的是坐标类型，`center`为图案的中心点，当绘制圆、多边形、矩形时返回中心点有助于依据中心点坐标进行导航，`rings`为图案边框上坐落的坐标，坐标类型都为wgs84


## 使用

**文件引入顺序建议**
```html
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.9/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" />
<script src="./cdmap/init.js"></script>
<link rel="stylesheet" href="./cdmap/index.min.css" />
<script src="./cdmap/index.min.js"></script>
<!-- 
  1、引入vue的js代码
  2、引入element-ui的js代码
  3、引入arcgis库
  4、引入element-ui的css代码
  5、引入cdmap的js代码
  6、引入cdmap的css代码
  7、引入此页面的css代码
 -->
```

**使用**
```html
<body>
  <div id="app">
    <cd-map @draw-complete="drawComplete"  :draw="canDraw" :init-map-type="mapType" :tools="['rectangle','circle']"/>
  </div>
</body>
<script>
  CDMapLoaded(function () {
    new Vue({
      el: "#app",
      data: {
        canDraw: true, 
        mapType: "imageservice", 
      },
      methods: {
        drawComplete: function (result) {
          console.log(result);
        },
      },
    });
  });
</script>
```

