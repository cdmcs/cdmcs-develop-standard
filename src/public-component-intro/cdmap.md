---
title: 成都地图
date: 2023-04-08
category:
  - 公共组件说明
---

<!-- more -->


:::tip
<a href="/demo/cdmap-demo.zip" download='cdmap使用示例下载.zip' >使用示例下载</a>
:::

## 项目目录
```text
- cdmap
    - index.min.css
    - index.min.js
```

## 参数说明
| 参数名        | 类型     | 说明                                             | 示例(可选值)                                                                                                         |
| :------------ | :------- | :----------------------------------------------- | :------------------------------------------------------------------------------------------------------------------- |
| draw          | Boolean  | 是否可以画图                                     | 可选值为true、false                                                                                                  |
| draw-graph    | Object   | 地图初始化时需要加载哪些图形，暂时仅支持单个图形 | 传参示例见下                                                                                                         |
| draw-complete | Function | 画完图形后返回图形的信息                         | 返回参数示例见下，会在图案绘制完成、图案绘制更新完成，撤销上一步图案、取消撤销上一步图案绘制时都会返回图案的几何信息 |
| mapType       | String   | 渲染的地图类型                                   | 可选值为：imageservice——影像电子地图和default——电子地图标准版                                                        |


## draw-graph
`draw-graph`接收的json格式如下：
```js
// 传矩形
{
  type: "rectangle",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传圆
{
  type: "circle",
  rings: [
    [
      [104.06423009726247, 30.660008027101323],
      [104.06422850190445, 30.65995726198627],
      [104.06422372212657, 30.659906697217938],
      [104.06421577679241, 30.659856532352357],
      [104.06420469725859, 30.65980696536734],
      [104.06419052725094, 30.659758191881135],
      [104.06417332269204, 30.6597104043804],
      [104.06415315148041, 30.659663791460577],
      [104.0641300932226, 30.65961853708156],
      [104.06410423891901, 30.65957481984171],
      [104.06407569060481, 30.659532812273],
      [104.06404456094711, 30.659492680160113],
      [104.06401097280045, 30.659454581886163],
      [104.06397505872192, 30.659418667807632],
      [104.06393696044798, 30.659385079660982],
      [104.06389682833509, 30.65935395000328],
      [104.06385482076638, 30.659325401689063],
      [104.06381110352653, 30.65929954738549],
      [104.06376584914752, 30.65927648912768],
      [104.06371923622768, 30.659256317916043],
      [104.06367144872695, 30.65923911335714],
      [104.06362267524074, 30.6592249433495],
      [104.06357310825572, 30.65921386381567],
      [104.06352294339015, 30.65920591848151],
      [104.06347237862181, 30.659201138703626],
      [104.06342161350676, 30.659199543345615],
      [104.06337084839171, 30.659201138703626],
      [104.06332028362337, 30.65920591848151],
      [104.0632701187578, 30.65921386381567],
      [104.06322055177279, 30.6592249433495],
      [104.06317177828657, 30.65923911335714],
      [104.06312399078584, 30.659256317916043],
      [104.06307737786601, 30.65927648912768],
      [104.06303212348699, 30.65929954738549],
      [104.06298840624714, 30.659325401689063],
      [104.06294639867843, 30.65935395000328],
      [104.06290626656555, 30.659385079660982],
      [104.0628681682916, 30.659418667807632],
      [104.06283225421308, 30.659454581886163],
      [104.06279866606641, 30.659492680160113],
      [104.06276753640871, 30.659532812273],
      [104.06273898809451, 30.65957481984171],
      [104.06271313379092, 30.65961853708156],
      [104.06269007553311, 30.659663791460577],
      [104.06266990432148, 30.6597104043804],
      [104.06265269976258, 30.659758191881135],
      [104.06263852975493, 30.65980696536734],
      [104.06262745022111, 30.659856532352357],
      [104.06261950488695, 30.659906697217938],
      [104.06261472510907, 30.65995726198627],
      [104.06261312975106, 30.660008027101323],
      [104.06261472510907, 30.660058792216375],
      [104.06261950488695, 30.66010935698471],
      [104.06262745022111, 30.66015952185029],
      [104.06263852975493, 30.660209088835305],
      [104.06265269976258, 30.66025786232151],
      [104.06266990432148, 30.660305649822245],
      [104.06269007553311, 30.66035226274207],
      [104.06271313379092, 30.660397517121087],
      [104.06273898809451, 30.66044123436094],
      [104.06276753640871, 30.660483241929647],
      [104.06279866606641, 30.660523374042533],
      [104.06283225421308, 30.660561472316484],
      [104.0628681682916, 30.660597386395015],
      [104.06290626656555, 30.660630974541665],
      [104.06294639867843, 30.660662104199368],
      [104.06298840624714, 30.660690652513583],
      [104.06303212348699, 30.660716506817156],
      [104.06307737786601, 30.660739565074966],
      [104.06312399078584, 30.660759736286604],
      [104.06317177828657, 30.66077694084551],
      [104.06322055177279, 30.660791110853147],
      [104.0632701187578, 30.660802190386978],
      [104.06332028362337, 30.660810135721135],
      [104.06337084839171, 30.66081491549902],
      [104.06342161350676, 30.660816510857032],
      [104.06347237862181, 30.66081491549902],
      [104.06352294339015, 30.660810135721135],
      [104.06357310825572, 30.660802190386978],
      [104.06362267524074, 30.660791110853147],
      [104.06367144872695, 30.66077694084551],
      [104.06371923622768, 30.660759736286604],
      [104.06376584914752, 30.660739565074966],
      [104.06381110352653, 30.660716506817156],
      [104.06385482076638, 30.660690652513583],
      [104.06389682833509, 30.660662104199368],
      [104.06393696044798, 30.660630974541665],
      [104.06397505872192, 30.660597386395015],
      [104.06401097280045, 30.660561472316484],
      [104.06404456094711, 30.660523374042533],
      [104.06407569060481, 30.660483241929647],
      [104.06410423891901, 30.66044123436094],
      [104.0641300932226, 30.660397517121087],
      [104.06415315148041, 30.66035226274207],
      [104.06417332269204, 30.660305649822245],
      [104.06419052725094, 30.66025786232151],
      [104.06420469725859, 30.660209088835305],
      [104.06421577679241, 30.66015952185029],
      [104.06422372212657, 30.66010935698471],
      [104.06422850190445, 30.660058792216375],
      [104.06423009726247, 30.660008027101323],
    ],
  ],
}

// 传多边形
{
  type: "polygon",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传折线图
{
  type: "polyline",
  rings: [
    [104.0623820814357, 30.660492963454033],
    [104.0644932960542, 30.660492963454033],
    [104.0644932960542, 30.659373055191953],
    [104.0623820814357, 30.659373055191953],
    [104.0623820814357, 30.660492963454033],
  ],
}

// 传点
{
  type: "point",
  rings: [104.06342161350676, 30.660008027101323],
},
```

由上可见`type`可以传的值有：
- `circle`——圆
- `rectangle`——矩形
- `polygon`——多边形
- `polyline`——折线图
- `point`——点

`rings`就是图案边框上坐落的坐标，组件会根据`rings`坐标组和`type`图案类型来绘制图案。需要注意的是，`rings`坐标都要为wgs84坐标类型，反正在地图上绘制会出现偏差

## draw-complete
`draw-complete`函数返回值如下：
```js
{
    "type": "point",
    "coordsType": "wgs84",
    "center": [
        104.06341089668128,
        30.66001338551406
    ],
    "rings": [
        104.06341089668128,
        30.66001338551406
    ]
}
```

以上`type`的值可以参考上面`type`的取值，`coordsType`返回的是坐标类型，`center`为图案的中心点，当绘制圆、多边形、矩形时返回中心点有助于依据中心点坐标进行导航，`rings`为图案边框上坐落的坐标，坐标类型都为wgs84


## 使用

**文件引入顺序建议**
```html
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.9/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://js.arcgis.com/4.28/"></script>
<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" />
<link rel="stylesheet" href="./cdmap/index.min.css" />
<script src="./cdmap/index.min.js"></script>
<!-- 
  1、引入vue的js代码
  2、引入element-ui的js代码
  3、引入arcgis库
  4、引入element-ui的css代码
  5、引入cdmap的js代码
  6、引入cdmap的css代码
  7、引入此页面的css代码
 -->
```

**使用**
```html
<body>
  <div id="app">
    <cd-map @draw-complete="drawComplete"  :draw="canDraw" :init-map-type="mapType" />
  </div>
</body>
<script>
  CDMapLoaded(function () {
    new Vue({
      el: "#app",
      data: {
        canDraw: true, 
        mapType: "imageservice", 
      },
      methods: {
        drawComplete: function (result) {
          console.log(result);
        },
      },
    });
  });
</script>
```

